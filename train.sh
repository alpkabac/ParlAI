parlai train_model \
-lr 7e-6 \
-bs 16 \
--task nsfwdata \
--model-file ~/ParlAI \
--model projects.blenderbot2.agents.blenderbot2:BlenderBot2FidAgent \
--dict-file zoo:blenderbot2/blenderbot2_400M/model.dict \
--wandb-log True \
--wandb-project bb2 \
--init-model zoo:blenderbot2/blenderbot2_400M/model \
--skip-generation True \
--knowledge-access-method memory_only \
--memory-key full_text \
--search-server None \
--metrics ppl \
--validation-metric ppl \
--model-parallel True \
--memory-decoder-model-file '' \
--datatype train:stream \
--generation-model transformer/generator \
--query-model bert_from_parlai_rag \
--rag-model-type token \
--rag-retriever-type dpr \
--max-doc-token-length 64 \
--dpr-model-file zoo:hallucination/bart_rag_token/model \
--beam-size 10 \
--beam-min-length 20 \
--beam-context-block-ngram 3 \
--beam-block-ngram 3 \
--beam-block-full-context False \
--inference beam \
--fp16-impl mem_efficient \
--optimizer mem_eff_adam \
--truncate 128 \
--text-truncate 128 \
--label-truncate 128 \
--history-add-global-end-token end \
--warmup-updates 100 \
--gold-document-titles-key select-docs-titles \
--insert-gold-docs True \
--activation gelu \
--attention-dropout 0.0 \
--dict-tokenizer gpt2 \
--dropout 0.1 \
--embedding-size 1024 \
--embeddings-scale false \
--ffn_size 4096 \
--force-fp16-tokens true \
--fp16 true \
--learn-positional-embeddings true \
--n-decoder-layers 12 \
--n-encoder-layers 12 \
--n-heads 16 \
--n-positions 1024 \